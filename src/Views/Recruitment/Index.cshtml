@using Microsoft.AspNetCore.Identity

@model IEnumerable<PlayerClass>

@inject SignInManager<IdentityUser> SignInManager

@section Style {
	<link rel="stylesheet"
		href="/css/shared.css" />
		
	<link rel="stylesheet"
		href="/css/pages/recruitment.css" />
}

<!-- Show apply link to regular visitors -->
@if (!User.IsInRole("Administrator"))
{
	<section class="apply">
		<a
		target="_blank" 
		rel="noopener noreferrer"
		class="apply__button"
		href="https://forms.gle/7ZDWePMVqoagR7Sy8">
			&lt;APPLY HERE&gt;
		</a>
	</section>
}

<form 
	asp-controller="Recruitment" 
	asp-action="Index" 
	method="post"
	class="form-container">

	<!-- The Administrator user can submit the changes made -->
	@if (User.IsInRole("Administrator"))
	{	
		<div class="submit-button-container">
			<button type="submit">Save</button>	
		</div>
	}

	<section id="class-grid">
		@foreach (var playerClass in Model)
		{
			<article class="class-card">
				<div class="card-title">
					<h2 
					class="class-name" 
					id=@("class" + playerClass.PlayerClassId)>
						@playerClass.Name
					</h2>
					
					<img
					class="class-icon"
					src=@playerClass.ImageUrl 
					alt="Icon representation of the player class." />			
				</div>

				<div class="specs">
					@foreach (var spec in playerClass.Specs)
					{
						<img
						class="spec-icon"
						src=@spec.ImageUrl 
						alt="Icon representation of the specialization." />

						<h2 class="spec-name">
							@(spec.Name + ":")
						</h2>

						<h2 class="demand" id=@("demand--" + spec.Demand.ToString("F"))>
							@spec.Demand.ToString("F")
						</h2>								

						<!-- The Administrator user can edit the demand for each specification -->
						@if (User.IsInRole("Administrator"))
						{
							<select
							asp-for="@playerClass.Specs.FirstOrDefault(s => s.SpecId == spec.SpecId).Demand"
							asp-items="Html.GetEnumSelectList<DemandEnum>()">
							</select>	
						}			
					}
				</div>
			</article>
		}
	</section>
</form>